<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Joshua D. Scarsbrook">
  <meta name="dcterms.date" content="2023-04-05">
  <title>Introduction to Console Security</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js//dist/reset.css">
  <link rel="stylesheet" href="https://unpkg.com/reveal.js//dist/reveal.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: visible;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="https://unpkg.com/reveal.js//dist/theme/black.css" id="theme">
  <style>
    /**
    * Dracula Dark theme for reveal.js.
    * Based on https://draculatheme.com
    */
    /**
    * Dracula colors by Zeno Rocha
    * https://draculatheme.com/contribute
    */
    html * {
      color-profile: sRGB;
      rendering-intent: auto;
    }

    section.has-light-background,
    section.has-light-background h1,
    section.has-light-background h2,
    section.has-light-background h3,
    section.has-light-background h4,
    section.has-light-background h5,
    section.has-light-background h6 {
      color: #282a36;
    }

    /*********************************************
    * GLOBAL STYLES
    *********************************************/
    :root {
      --color-1: #e0e2db;
      --color-2: #d67ab1;
      --color-3: #676aa2;
      --color-4: #72ac9a;
      --color-5: #0d0c1d;

      --r-background-color: var(--color-5);
      --r-main-font: -apple-system, BlinkMacSystemFont, avenir next, avenir,
        segoe ui, helvetica neue, helvetica, Cantarell, Ubuntu, roboto, noto,
        arial, sans-serif;
      --r-main-font-size: 30px;
      --r-main-color: var(--color-1);
      --r-block-margin: 20px;
      --r-heading-margin: 0 0 20px 0;
      --r-heading-font: Roboto Mono, monospace;
      --r-heading-color: var(--color-2);
      --r-heading-line-height: 1.2;
      --r-heading-letter-spacing: normal;
      --r-heading-text-transform: none;
      --r-heading-text-shadow: none;
      --r-heading-font-weight: normal;
      --r-heading1-text-shadow: none;
      --r-heading1-size: 2.77em;
      --r-heading2-size: 2.11em;
      --r-heading3-size: 1.55em;
      --r-heading4-size: 1em;
      --r-code-font: Roboto Mono, monospace;
      --r-link-color: var(--color-4);
      --r-link-color-dark: var(--color-4);
      --r-link-color-hover: var(--color-4);
      --r-selection-background-color: var(--color-5);
      --r-selection-color: var(--color-5);
    }

    .reveal-viewport {
      background: var(--color-5);
      background-color: var(--r-background-color);
    }

    .reveal {
      font-family: var(--r-main-font);
      font-size: var(--r-main-font-size);
      font-weight: normal;
      color: var(--r-main-color);
    }

    .reveal ::selection {
      color: var(--r-selection-color);
      background: var(--r-selection-background-color);
      text-shadow: none;
    }

    .reveal ::-moz-selection {
      color: var(--r-selection-color);
      background: var(--r-selection-background-color);
      text-shadow: none;
    }

    .reveal .slides section,
    .reveal .slides section > section {
      line-height: 1.3;
      font-weight: inherit;
    }

    /*********************************************
    * HEADERS
    *********************************************/
    .reveal h1,
    .reveal h2,
    .reveal h3,
    .reveal h4,
    .reveal h5,
    .reveal h6 {
      margin: var(--r-heading-margin);
      color: var(--r-heading-color);
      font-family: var(--r-heading-font);
      font-weight: var(--r-heading-font-weight);
      line-height: var(--r-heading-line-height);
      letter-spacing: var(--r-heading-letter-spacing);
      text-transform: var(--r-heading-text-transform);
      text-shadow: var(--r-heading-text-shadow);
      word-wrap: break-word;
    }

    .reveal h1 {
      font-size: var(--r-heading1-size);
    }

    .reveal h2 {
      font-size: var(--r-heading2-size);
    }

    .reveal h3 {
      font-size: var(--r-heading3-size);
    }

    .reveal h4 {
      font-size: var(--r-heading4-size);
    }

    .reveal h1 {
      text-shadow: var(--r-heading1-text-shadow);
    }

    /*********************************************
    * OTHER
    *********************************************/
    .reveal p {
      margin: var(--r-block-margin) 0;
      line-height: 1.3;
    }

    /* Remove trailing margins after titles */
    .reveal h1:last-child,
    .reveal h2:last-child,
    .reveal h3:last-child,
    .reveal h4:last-child,
    .reveal h5:last-child,
    .reveal h6:last-child {
      margin-bottom: 0;
    }

    /* Ensure certain elements are never larger than the slide itself */
    .reveal img,
    .reveal video,
    .reveal iframe {
      max-width: 95%;
      max-height: 95%;
    }

    .reveal strong,
    .reveal b {
      font-weight: bold;
    }

    .reveal em {
      font-style: italic;
    }

    .reveal ol,
    .reveal dl,
    .reveal ul {
      display: inline-block;
      text-align: left;
      margin: 0 0 0 1em;
    }

    .reveal ol {
      list-style-type: decimal;
    }

    .reveal ul {
      list-style-type: disc;
    }

    .reveal ul ul {
      list-style-type: square;
    }

    .reveal ul ul ul {
      list-style-type: circle;
    }

    .reveal ul ul,
    .reveal ul ol,
    .reveal ol ol,
    .reveal ol ul {
      display: block;
      margin-left: 40px;
    }

    .reveal dt {
      font-weight: bold;
    }

    .reveal dd {
      margin-left: 40px;
    }

    .reveal blockquote {
      display: block;
      position: relative;
      width: 70%;
      margin: var(--r-block-margin) auto;
      padding: 5px;
      font-style: italic;
      background: rgba(255, 255, 255, 0.05);
      box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.2);
    }

    .reveal blockquote p:first-child,
    .reveal blockquote p:last-child {
      display: inline-block;
    }

    .reveal q {
      font-style: italic;
    }

    .reveal pre {
      display: block;
      position: relative;
      width: 90%;
      margin: var(--r-block-margin) auto;
      text-align: left;
      font-size: 0.55em;
      font-family: var(--r-code-font);
      line-height: 1.2em;
      word-wrap: break-word;
      box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.15);
    }

    .reveal code {
      font-family: var(--r-code-font);
      text-transform: none;
      tab-size: 2;
    }

    .reveal pre code {
      display: block;
      padding: 5px;
      overflow: auto;
      max-height: 400px;
      word-wrap: normal;
    }

    .reveal .code-wrapper {
      white-space: normal;
    }

    .reveal .code-wrapper code {
      white-space: pre;
    }

    .reveal table {
      margin: auto;
      border-collapse: collapse;
      border-spacing: 0;
    }

    .reveal table th {
      font-weight: bold;
    }

    .reveal table th,
    .reveal table td {
      text-align: left;
      padding: 0.2em 0.5em 0.2em 0.5em;
      border-bottom: 1px solid;
    }

    .reveal table th[align="center"],
    .reveal table td[align="center"] {
      text-align: center;
    }

    .reveal table th[align="right"],
    .reveal table td[align="right"] {
      text-align: right;
    }

    .reveal table tbody tr:last-child th,
    .reveal table tbody tr:last-child td {
      border-bottom: none;
    }

    .reveal sup {
      vertical-align: super;
      font-size: smaller;
    }

    .reveal sub {
      vertical-align: sub;
      font-size: smaller;
    }

    .reveal small {
      display: inline-block;
      font-size: 0.6em;
      line-height: 1.2em;
      vertical-align: top;
    }

    .reveal small * {
      vertical-align: top;
    }

    .reveal img {
      margin: var(--r-block-margin) 0;
    }

    /*********************************************
    * LINKS
    *********************************************/
    .reveal a {
      color: var(--r-link-color);
      text-decoration: none;
      transition: color 0.15s ease;
    }

    .reveal a:hover {
      color: var(--r-link-color-hover);
      text-shadow: none;
      border: none;
    }

    .reveal .roll span:after {
      color: #fff;
      background: var(--r-link-color-dark);
    }

    /*********************************************
    * Frame helper
    *********************************************/
    .reveal .r-frame {
      border: 4px solid var(--r-main-color);
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);
    }

    .reveal a .r-frame {
      transition: all 0.15s linear;
    }

    .reveal a:hover .r-frame {
      border-color: var(--r-link-color);
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.55);
    }

    /*********************************************
    * NAVIGATION CONTROLS
    *********************************************/
    .reveal .controls {
      color: var(--r-link-color);
    }

    /*********************************************
    * PROGRESS BAR
    *********************************************/
    .reveal .progress {
      background: rgba(0, 0, 0, 0.2);
      color: var(--r-link-color);
    }

    /*********************************************
    * PRINT BACKGROUND
    *********************************************/
    @media print {
      .backgrounds {
        background-color: var(--r-background-color);
      }
    }
    :root {
      --r-bold-color: var(--color-3);
      --r-italic-color: var(--color-4);
      --r-inline-code-color: var(--color-2);
      --r-list-bullet-color: var(--color-2);
    }

    .reveal strong,
    .reveal b {
      color: var(--r-bold-color);
    }

    .reveal em,
    .reveal i,
    .reveal blockquote {
      color: var(--r-italic-color);
    }

    .reveal code {
      color: var(--r-inline-code-color);
    }

    .reveal ul {
      list-style: none;
    }

    .reveal ul li::before {
      content: "•";
      color: var(--r-list-bullet-color);
      display: inline-block;
      width: 1em;
      margin-left: -1em;
    }

    .reveal ol {
      list-style: none;
      counter-reset: li;
    }

    .reveal ol li::before {
      content: counter(li) ".";
      color: var(--r-list-bullet-color);
      display: inline-block;
      width: 2em;
      margin-left: -2.5em;
      margin-right: 0.5em;
      text-align: right;
    }

    .reveal ol li {
      counter-increment: li;
    }

    .reveal .smaller {
      font-size: 70%;
      text-align: left;
    }

    .reveal .footnotes {
      position: fixed !important;
      bottom: 0;
      max-height: 100px;
    }

    .title {
    }

    .subtitle {
    }

    .author {
    }

    .date {
    }

    .reveal .slide-background-content {
      filter: blur(10px) saturate(0.7) brightness(0.5);
    }
  </style>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Introduction to Console Security</h1>
  <p class="subtitle">Your Game Console is not a PC</p>
  <p class="author">Joshua D. Scarsbrook</p>
  <p class="date">April 5, 2023</p>
</section>

<section class="slide level2">

<h3
id="joshuajoshua-pc3-whoami"><code>joshua@joshua-pc3 $ whoami</code></h3>
<p>Joshua Scarsbrook</p>
<p>Research Officer/PhD Student at the University of Queensland</p>
<p>Researching Applied Cyber Security and Cyber Security in
Education</p>
<p>Interested in Operating Systems and Embedded Hardware</p>
</section>
<section id="disclaimer" class="slide level2">
<h2>Disclaimer</h2>
<p><strong>I did not hack these consoles myself or develop the
exploits.</strong> All the content in this presentation is from publicly
available sources online.</p>
<p>The main references I will be using are:</p>
<ul>
<li><a href="https://hackmii.com/">https://hackmii.com/</a> (Focuses on
Nintendo Wii)</li>
<li><a
href="https://wiibrew.org/wiki/Main_Page">https://wiibrew.org/wiki/Main_Page</a>
(Focuses on Nintendo Wii)</li>
<li><a href="https://xosft.dev/wiki/">https://xosft.dev/wiki/</a> (Xbox
One Research Wiki)</li>
<li><a
href="https://fail0verflow.com/blog/">https://fail0verflow.com/blog/</a>
(Fail0verflow “focuses on Wii U and PS4”)</li>
<li><a
href="https://www.copetti.org/writings/consoles/">https://www.copetti.org/writings/consoles/</a>
(Great research on the hardware architecture of all consoles)</li>
<li><a
href="https://www.platformsecuritysummit.com/2019/speaker/chen/">https://www.platformsecuritysummit.com/2019/speaker/chen/</a>
(Great talk by Tony Chen at Microsoft discussing the security
architecture of the Xbox One)</li>
</ul>
</section>
<section id="overview" class="slide level2">
<h2>Overview</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>What is a Console?</li>
<li>Hardware Security Assumptions</li>
<li>Nintendo Wii
<ul>
<li>System Architecture</li>
<li>Secure Boot Process</li>
</ul></li>
<li>Nintendo Wii U
<ul>
<li>System Architecture</li>
<li>Secure Boot Process</li>
</ul></li>
<li>Playstation 4
<ul>
<li>System Architecture</li>
</ul></li>
<li>Xbox One
<ul>
<li>System Architecture</li>
</ul></li>
</ul>
</div><div class="column" style="width:60%;">
<figure>
<img data-src="./images/consoles.png" alt="Consoles" />
<figcaption aria-hidden="true">Consoles</figcaption>
</figure>
</div>
</div>
<aside class="notes">
<p>The boot process of Xbox Ones and PS4s are not that interesting. It’s
very similar to the Wii U.</p>
<p>I’m intentionally using the first generation images of each console
since the later revisions can come with major hardware changes (e.g. PS4
Pro and Xbox One X).</p>
</aside>
</section>
<section id="what-is-a-pc" class="slide level2">
<h2>What is a PC?</h2>
<p><sup><a href="https://fail0verflow.com/media/33c3-slides/#/24">Source
https://fail0verflow.com/media/33c3-slides/#/24</a></sup></p>
<ul>
<li>8259 Programmable Interrupt Controller (PIC)</li>
<li>8253 Programmable Interval Timer (PIT)</li>
<li>8250 UART at I/O <code>3f8h</code></li>
<li>8042 PS/2 Keyboard Controller</li>
<li>MC146818 RTC/CMOS</li>
<li>ISA bus</li>
<li>VGA</li>
</ul>
</section>
<section id="what-is-a-game-console" class="slide level2">
<h2>What is a Game Console?</h2>
<h3 id="not-a-pc."><em>Not a PC.</em></h3>
<aside class="notes">
<p>First things first. Game Consoles are not PCs.</p>
<p>They are unique embedded platforms bespoke silicon and bespoke
operating systems. Assumptions that work for PCs very rarely carry over
to consoles.</p>
<p>For instance all the consoles we will discuss have strongly encrypted
storage using console managed keys. In a PC sense all of them use
full-disk encryption.</p>
</aside>
</section>
<section class="slide level2">

<h3 id="pc-security-architecture">PC Security Architecture</h3>
<p><strong>TPM (Trusted Platform Module)</strong></p>
<p>Security microcontroller handling measurement and secure key
storage.</p>
<p><strong>SGX (Software Guard Extensions)</strong></p>
<p>Provides application isolation using hardened enclaves.</p>
<p><strong>Intel CSME / AMD PSP / ARM TrustZone</strong></p>
<p>Embedded CPU core running manufacturer firmware providing bootstrap,
security, and remote management.</p>
<div class="smaller">
<p><em>Thanks Guangdong Bai for suggesting this slide.</em></p>
</div>
</section>
<section class="slide level2">

<h3 id="hardware-security-assumptions---whats-at-stake">Hardware
Security Assumptions - What’s at Stake</h3>
<div class="smaller">
<p>Only the CPU silicon die is trustworthy (not economically feasible to
mod 28nm die).</p>
<ul>
<li>Intercepting and modifying data on any motherboard bus is easy.</li>
<li>Any SoC external pin will be manipulated in the worst possible way.
JTAG Debug, Clock, voltage, and reset pins are primary targets.</li>
<li>All PCIe, SATA, USB data can certainly be manipulated.</li>
</ul>
<p>Current PC hardware design is not resilient against hardware
attacks:</p>
<ul>
<li>DRAM not encrypted or integrity protected</li>
<li>Bus between CPU and South Bridge not protected.
<ul>
<li>Most of Intel’s “secure boot” functionality implemented in South
Bridge.</li>
<li>At boot time, CPU asks South bridge (though insecure bus) whenever
it needs to secure boot.</li>
</ul></li>
<li>TPM chip connected to CPU through insecure LPC bus. Any TPM
measurement can be forged.</li>
</ul>
</div>
<p><a
href="https://www.platformsecuritysummit.com/2019/speaker/chen/">Source
https://www.platformsecuritysummit.com/2019/speaker/chen/</a></p>
<aside class="notes">
<p>Now about security. Why are consoles so interesting from a security
standpoint?</p>
<p>This slide lists a few of the assumptions Microsoft made when
developing the security system of the Xbox One. You can’t trust anything
outside the main CPU silicon. Even the pins can be manipulated to lead
to security compromises. The RAM has to be encrypted and protected.
Assume that it will be compromised and modified.</p>
<p>Most of the research you’ll see later in this presentation comes from
consoles that didn’t yet learn these lessons.</p>
</aside>
</section>
<section id="the-nintendo-wii" class="slide level2">
<h2>The Nintendo Wii</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><strong>Architecture:</strong> GameCube++</p>
<p><strong>CPU:</strong></p>
<ul>
<li>IBM PowerPC “Broadway”</li>
<li>ARM926EJ-S “Starlet”</li>
</ul>
<p><strong>GPU:</strong></p>
<ul>
<li>ATI Graphics (ATI is now owned by AMD)</li>
<li>GameCube’s GPU</li>
</ul>
<p><strong>RAM:</strong> “It’s complicated”</p>
</div><div class="column" style="width:65%;">
<p><img data-src="./images/wii-arch.png" alt="Architecture Diagram" />
<strong>Source:</strong> <a
href="https://www.copetti.org/writings/consoles/wii/">https://www.copetti.org/writings/consoles/wii/</a></p>
</div>
</div>
<aside class="notes">
<p>The Wii is just a Nintendo GameCube with additional hardware. I won’t
be going over the security details of the GameCube in this talk since
it’s not super interesting. Fun fact: Most consoles use AMD GPUs these
days. The Nintendo Switch is the odd one out using a Nvidia GPU. Get
used to complicated architecture diagrams. Yes the Wifi is connected via
a SD Card like interface. That’s pretty common. Looking at this diagram
which is the main CPU?</p>
</aside>
</section>
<section class="slide level2">

<h3 id="side-note-one-time-programmable-memory-otpefuses">Side Note:
One-time Programmable Memory (OTP/eFUSEs)</h3>
<p>Super common kind of memory in modern systems that is used to set
system configuration at manufacturing time.</p>
<p>You don’t have enough money to reprogram them (requires
specialized(/very expensive)) silicon rework hardware.</p>
<p>Common in lots of modern hardware:</p>
<ul>
<li>All the consoles we’re talking about.</li>
<li>Most Android Phones.</li>
<li>All iPhones/iPads/iOS devices.</li>
</ul>
<aside class="notes">
<p>As a side note since it will keep coming up. One time programmable
memory (sometimes called eFUSEs) are super common in modern hardware
from your mobile phones to game consoles. They are little metal jumpers
inside the CPU that get overvolted to program them. This programming
processes involves “blowing” this part of the system using high voltage.
They are the difference between super open development hardware and the
locked down devices that are sold to consumers.</p>
</aside>
</section>
<section id="wii-starlet-vs.-broadway" class="slide level2">
<h2>Wii: Starlet vs. Broadway</h2>
<p><strong>Broadway (IBM PowerPC (PPC))</strong></p>
<ul>
<li>It’s where the games (and System Menu) run.</li>
<li>Runs a Operating System called Revolution OS.</li>
<li>Controlled by Starlet.</li>
</ul>
<p><strong>Starlet (ARM)</strong></p>
<ul>
<li>It’s where the main “operating system” (IOS) runs.</li>
<li>Connected to hardware.</li>
<li>Handles the boot process for the rest of the system.</li>
</ul>
<aside class="notes">
<p>The Nintendo Wii has 2 different processors. The Starlet and the
Broadway. The Starlet is a ARM core and the Broadway is a PowerPC core
(like Apple used to run on it’s Macs). PowerPC was common for this
console generation. The Xbox 360 and Playstation 3 both had PowerPC
based processors. IOS here does not refer to Apple’s iOS or Cisco’s IOS
(It has no relation to either). There is no real operating system
running on Broadway. Games from this generation (and previous) provide
their own operating system and run independently of other software.</p>
</aside>
</section>
<section id="wii-operating-system-ios" class="slide level2">
<h2>Wii Operating System: IOS</h2>
<ul>
<li>It’s not really a normal operating system.</li>
<li>It’s a Microkernel (If you’ve used Minix before it looks
familiar).</li>
<li>It’s closest relative is Unix or Plan 9.</li>
<li>The Wii stores multiple copies of IOS and games each target a
specific version.</li>
<li>The version of IOS being used can be changed easily.</li>
</ul>
<aside class="notes">
<p>As I said before there’s no real operating system running on
Broadway. Each game brings its own Operating System. Starlark does run a
real operating system called IOS. It’s a vaguely a Microkernel and looks
kinda like Unix on the surface. IOS runs at a higher permission level
than code running on Broadway (e.g. the System Menu and Games).</p>
</aside>
</section>
<section class="slide level2">

<figure>
<img data-src="./images/wii-boot-process.svg" alt="Wii Boot Process" />
<figcaption aria-hidden="true"><strong>Wii Boot
Process</strong></figcaption>
</figure>
<aside class="notes">
<p>Now onto the boot process. All of this establishes a “Chain of
Trust”. Everything running on the system has to be approved by the code
running before it. The root is Nintendo so they have final say in what
runs on the Wii.</p>
<p>Boot0 is the first thing that runs when you turn on your Wii. It
comes from “Mask ROM” which is part of the silicon. Boot1 is loaded from
flash by Boot0. Boot2 is loaded from flash by Boot1 etc.</p>
<p>So why all the steps. Mask ROM is really expensive so Boot0 had to be
super small. All it can do is load Boot1 and check it’s hash against a
SHA1 stored in One-time Programmable Memory. Boot1 loads Boot2 from
flash and uses RSA signature verification to verify it. Boot2 can
therefore be updated. Boot2 loads IOS which loads the system menu. This
is verified using a system of “Tickets” which are too much of a tangent
to get into right now. Boot1 can not be updated once the console leaves
the factory. Boot2 has been updated by Nintendo (not very
successfully).</p>
</aside>
</section>
<section id="notable-wii-exploits" class="slide level2">
<h2>Notable Wii Exploits</h2>
<p><strong>Tweezer Attack</strong></p>
<ul>
<li>Shorting address pins while in GameCube compatibility mode allowed
dumping of memory.</li>
</ul>
<p><strong>Twilight Hack</strong></p>
<ul>
<li>It’s a buffer overflow in the save data of The Legend of Zelda:
Twilight Princess.</li>
</ul>
<p><strong>Boot1 Fake-signing Bug</strong></p>
<ul>
<li>Allows replacing Boot2 with a custom executable. Gives full
low-level control over the system. Not fixable in software since Boot1
can’t be updated.</li>
</ul>
<aside class="notes">
<p>And finally what are the exploits.</p>
<p>The tweezer attack started it all. Since the Gamecube mode was
relatively easy to compromise people started there and moved upwards.
The tweezer attack allowed dumping significant parts of system memory
early in the console’s lifecycle.</p>
<p>“Fake-signing” refers to a process to forge a digital signature. In
this case it was used to make a replacement for Boot2 allowing lower
level control of the Nintendo Wii. Also very useful as brick protection
since the Nintendo Wii is a very fragile piece of hardware.</p>
<p>A lot of these exploits were made easier since the Wii only verifies
software as it’s being installed. Once it’s on the system it’s
considered trusted.</p>
</aside>
</section>
<section id="the-nintendo-wii-u" class="slide level2">
<h2>The Nintendo Wii U</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><strong>Architecture:</strong> Wii++ (Not a PC)</p>
<p><strong>CPU:</strong></p>
<ul>
<li>3 core IBM “Espresso”</li>
<li>ARM “Starbuck”</li>
</ul>
<p><strong>GPU:</strong></p>
<ul>
<li>Wii’s GPU (Based on ATI)</li>
<li>AMD Radeon</li>
</ul>
<p><strong>RAM:</strong> 2 GB (+ some other bits)</p>
</div><div class="column" style="width:65%;">
<p><img data-src="./images/wiiu-arch.webp" alt="Architecture Diagram" />
<strong>Source:</strong> <a
href="https://www.copetti.org/writings/consoles/wiiu/">https://www.copetti.org/writings/consoles/wiiu/</a></p>
</div>
</div>
<aside class="notes">
<p>Welcome to the Wii U. Nintendo had a hell of a time advertising this
at the start since everyone thought it was a Wii. Everyone was only
mostly wrong. Notice here how there’s nothing removed compared to the
Wii but only some new additions. This is for backwards compatibility
reasons. The big additions here are more processors, more RAM, and a
modern GPU. Otherwise the Architecture looks like more of the same. The
“Latte” is still the main CPU and the Espresso is under its control.</p>
</aside>
</section>
<section id="wii-vs.-wii-u-overview" class="slide level2">
<h2>Wii vs. Wii U: Overview</h2>
<table>
<colgroup>
<col style="width: 51%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Wii</strong></th>
<th><strong>Wii U</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Games run on the Broadway, on the bare metal.</td>
<td>Runs Cafe OS, a custom multiprocess OS running on the Espresso with
process isolation and memory management.</td>
</tr>
<tr class="even">
<td>The Starlet runs IOS, a microkernel OS handling security, crypto and
I/O services</td>
<td>Similar, but IOS is larger and significantly changed (we call it
IOSU).</td>
</tr>
<tr class="odd">
<td>Games and software are loaded from disc or NAND flash. RSA
signatures checked at installation time, not launch time.</td>
<td>Also includes 8 or 32GB of eMMC storage for user software. RSA
signatures also checked at launch time.</td>
</tr>
</tbody>
</table>
<p><a href="https://fail0verflow.com/media/30c3-slides/#/6">Source
https://fail0verflow.com/media/30c3-slides/#/6</a></p>
<aside class="notes">
<p>Rather than looking at the entire architecture of the Wii U let’s
just talk about the differences from the Wii.</p>
<p>There are a few useful security advancements here and a real
operating system running on Espresso. The Wii used to effectively
implement device drivers inside games so this is a major
advancement.</p>
</aside>
</section>
<section class="slide level2">

<figure>
<img data-src="./images/wiiu-boot-process.svg"
alt="Wii U Boot Process" />
<figcaption aria-hidden="true"><strong>Wii U Boot
Process</strong></figcaption>
</figure>
<aside class="notes">
<p>The Wii U boots in mostly the same way as the Wii but we see a few
more parts going on here. Unlike the Wii the Wii U runs a operating
system on the Espresso called Cafe OS. Revolution OS is more of a shared
software library linked into games rather than a traditional operating
system.</p>
<p>Boot0 and Boot1 are now effectively merged and running from Mask ROM.
It also supports booting a signed recovery image which is a super useful
compared to the Wii which could be easily broken by badly written
software. Boot2 (technically Boot1) handles booting IOSU.</p>
<p>There’s a separate Chain of Trust for the Espresso started from a
“Mask ROM”. It boots signed and encrypted “ancast” images only. This
boots Cafe OS which is a real operating system running on Espresso.</p>
<p>We also see some backwards compatibility here in the form of
“cafe2wii”. This temporarily makes your Wii U a Wii and allows you to
run Wii games.</p>
</aside>
</section>
<section id="wii-u-exploits" class="slide level2">
<h2>Wii U Exploits</h2>
<p><strong><em>Wii Compatibility Mode</em> exploits</strong></p>
<ul>
<li>They got in through the Nintendo Wii compatibility mode.</li>
</ul>
<p><strong>Nintendo</strong></p>
<ul>
<li>They left a memory flag to reenable boot0.</li>
<li>They didn’t strip the symbols of cafe2wii.</li>
</ul>
<p><strong>WebKit bugs</strong></p>
<ul>
<li>Incredibly common and super boring.</li>
</ul>
</section>
<section class="slide level2">

<h3 id="the-sony-playstation-4-overview">The Sony Playstation 4:
Overview</h3>
<div class="columns">
<div class="column" style="width:35%;">
<p>The most PC-like <em>not a PC</em> we’ve seen so far.</p>
<ul>
<li>It has a x86_64 CPU</li>
<li>It has a AMD GPU</li>
<li>It runs FreeBSD</li>
</ul>
</div><div class="column" style="width:65%;">
<p><img data-src="./images/ps4-highres.jpg" /></p>
</div>
</div>
<aside class="notes">
<p>The PS4 looks like a PC on the surface. It has a x86_64 CPU. It could
technically run Windows or Linux. It has a AMD GPU. You might have
something very similar in your laptop/desktop. It runs FreeBSD which you
can download and run on your desktop now. But it’s not quite that
simple.</p>
<p>The PS4 is a real oddity. The hard drive is connected via USB
(technically it has USB-to-SATA internally) That Aeolia southbridge
should look familiar to people who were listening 5 minutes ago when we
were talking about the Wii and Wii U. It’s not that though. The
Southbridge is running FreeBSD as well but it doesn’t have nearly the
same level of control as the ARM CPU on the Wii and Wii U. And what did
I say about it running FreeBSD?</p>
</aside>
</section>
<section class="slide level2">

<h3 id="the-sony-playstation-4">The Sony Playstation 4</h3>
<div class="columns">
<div class="column" style="width:35%;">
<p><strong>Architecture:</strong> Like a PC (but…)</p>
<p><strong>CPU:</strong></p>
<ul>
<li>AMD x86_64</li>
<li>Marvell Armada (ARM)</li>
</ul>
<p><strong>GPU:</strong></p>
<ul>
<li>AMD GCN “Sea Islands”</li>
</ul>
<p><strong>RAM:</strong> 8GB</p>
</div><div class="column" style="width:65%;">
<figure>
<img data-src="./images/ps4-arch.svg" alt="Architecture Diagram" />
<figcaption aria-hidden="true">Architecture Diagram</figcaption>
</figure>
</div>
</div>
<aside class="notes">
<p>The PS4 runs an operating system based on FreeBSD. It provides a very
FreeBSD like user space API to games with a few custom additions.</p>
<p>Both the PS3 and PS5 run a operating system of the same lineage.</p>
<p>Yes the system menu is written in C# and runs with Mono. Sony used to
be kinda interesting in getting people to run games in .Net around the
same time Microsoft was (does anyone remember XNA).</p>
</aside>
</section>
<section id="section" class="slide level2"
data-background-image="./images/ps4-system-menu.jpg">
<h2 data-background-image="./images/ps4-system-menu.jpg"></h2>
<p>It’s based on FreeBSD with plenty of modifications by Sony.</p>
<p>The PS3, PS4, and PS5 all use similar operating systems.</p>
<p>The system menu is written in C#.</p>
<aside class="notes">
<p>I didn’t put anything on this slide since the content is so
boring.</p>
<p>The PS4 runs a derivative of FreeBSD and Sony did a bunch of random
changes. Once you get code running in userland your pretty close to
getting something running in kernel mode.</p>
<p>How do you get something running in Userland? Well it has a web
browser so you just exploit the browser.</p>
</aside>
</section>
<section class="slide level2">

<h3 id="ps4-exploits">PS4 Exploits</h3>
<ul>
<li>Webkit</li>
<li>FreeBSD Kernel Exploits</li>
</ul>
</section>
<section class="slide level2">

<h3 id="the-microsoft-xbox-one">The Microsoft Xbox One</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Architecture:</strong> Not a PC (not a PC4 either).</p>
<p><strong>CPUs:</strong> AMD x86_64</p>
<p><strong>GPUs:</strong> AMD Radeon</p>
<p><strong>RAM:</strong> 8GB</p>
<p><strong>Operating System:</strong> Windows</p>
</div><div class="column" style="width:50%;">
<figure>
<img data-src="./images/durango_southbridge_soc.gif"
alt="Xbox One Architecture Diagram" />
<figcaption aria-hidden="true">Xbox One Architecture
Diagram</figcaption>
</figure>
</div>
</div>
<p><em>Source: <a
href="https://xosft.dev/wiki/southbridge/">https://xosft.dev/wiki/southbridge/</a></em></p>
<aside class="notes">
<p>On the surface this may remind you fo the PS4. The similarities end
with the CPU core and GPU core. The Southbridge is considered untrusted
on the Xbox One. The Main SoC is definitely the main CPU on the system.
Everything is running there. The Xbox One runs Windows (I’ll elaborate
on this soon).</p>
</aside>
</section>
<section id="what-is-windows" class="slide level2">
<h2>What is Windows?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Windows NT Kernel</strong></p>
<ul>
<li>Uses native APIs.</li>
<li>Internally structured like Unix but different.</li>
<li>Uses UNC path notation as the “native” format.</li>
<li>First released in 1993 (Happy Birthday in July).</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Win32 APIs</strong></p>
<ul>
<li>First released in 1985.</li>
<li>Uses <code>C:\</code> and other drive letters.</li>
<li>Your Windows desktop and most Windows UI is provided by Win32.</li>
<li>A completely different set of APIs to the NT Native APIs.</li>
</ul>
</div>
</div>
<p>All the Xbox consoles have used derivatives of Windows NT.</p>
<p>The Xbox One(/ Series X/S) run some Win32 APIs but not
everything.</p>
<aside class="notes">
<p>So I just said the Xbox runs Windows.</p>
<p>That depends on your definition of Windows though. It doesn’t have a
Desktop or support for running regular Windows apps. It does have drive
letters but many more than your used to.</p>
</aside>
</section>
<section class="slide level2">

<h3 id="hypervisors-on-game-consoles">Hypervisors on Game Consoles</h3>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Does not have a Hypervisor</strong></p>
<ul>
<li>Playstation 4</li>
<li>Nintendo Wii</li>
<li>Nintendo Wii U</li>
<li>Nintendo Switch</li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Has a Hypervisor</strong></p>
<ul>
<li>Playstation 3</li>
<li>Playstation 5</li>
<li>Xbox 360</li>
<li>Xbox One</li>
<li>Xbox Series S/X</li>
</ul>
</div>
</div>
<p><strong>What is a Hypervisor</strong></p>
<p>A Hypervisor virtualizes access to hardware resources. At a basic
level it intercepts any hardware access and turns it into a protected
interrupt.</p>
<aside class="notes">
<p>Well oops.</p>
<p>So a core part of the system architecture of the Xbox One is its use
of a Hypervisor to segment different kinds of applications.</p>
<p>These are super common on consoles except the ones we’ve talked
about.</p>
<p>On the Wii and Wii U IOS and IOSU act as mediators for hardware
access so are analogous to hypervisors on those platforms. But they act
more like weird operating systems rather than the machine virtualisation
done on the consoles with hypervisors.</p>
<p>As a general note the consoles running hypervisors have more than one
operating system running at the same time.</p>
</aside>
</section>
<section class="slide level2">

<h3 id="xbox-one-operating-systems">Xbox One Operating Systems</h3>
<p><strong>Host OS:</strong> Host operating system running modified
Windows 8. No GUI presented to the User.</p>
<p><strong>System OS:</strong> Runs the main UI and dashboard. Based on
Windows ‘OneCoreUAP’.</p>
<p><strong>Game/ERA OS:</strong> Games run inside here. Uses Windows 8
like Host OS but modified.</p>
<aside class="notes">
<p>There are 3 different Windows installations you deal with on the Xbox
One.</p>
<p>The Host OS is the first operating system that boots and it hosts all
the Virtual Machines. The System OS is what you interact with
day-to-day. It’s also where most of the applications run. There’s less
resources available here. The Game/ERA OS is only used for games. Each
game gets its own Virtual Machine. Here you can use most of the consoles
resources.</p>
</aside>
</section>
<section class="slide level2">

<h3 id="xbox-one-exploits">Xbox One Exploits</h3>
<p>Nothing Notable.</p>
<aside class="notes">
<p>The Xbox One has kept to a very high degree of system security.</p>
<p>This is down to a few basic reasons. The web browser requires a
connection to Xbox Live and up-to-date system software. This means any
browser based exploits are highly limited. There’s a development mode
you can enable that gives you sandboxed access to System OS. That’s all
you really need for Homebrew. The console runs Windows so any exploits
targeting the console possibility target desktop Windows as well. This
means anyone who discovers an exploit is more likely to sell it rather
than use it for piracy.</p>
<p>The research that has happened is due to leaked console development
kits mostly.</p>
</aside>
</section>
<section class="slide level2">

<h3 id="developer-kits">Developer Kits</h3>
<ul>
<li>Requires a NDA to purchase (*).</li>
<li>Modern ones need regular internet access to work (*).</li>
<li>Generally the same hardware (maybe more networking or RAM).
<ul>
<li><em>For the Xbox One it’s exactly the same hardware. (*)</em></li>
</ul></li>
<li>Connects to a PC and runs development signed code (*).</li>
<li>Can’t run retail games (*).</li>
</ul>
</section>
<section class="slide level2">

<h3 id="other-consoles">Other Consoles</h3>
<p><strong>Playstation 3</strong></p>
<ul>
<li>Thoroughly compromised due to a signing bug in the system. (Similar
to Nintendo Wii)</li>
<li>Runs a similar operating system to the PS4 and weird hardware based
on IBM’s Cell processor.</li>
</ul>
<p><strong>Nintendo Switch</strong></p>
<ul>
<li>Uses a Nvidia Tegra SoC.</li>
<li>Old consoles have a bootrom vulnerability granting low-level
access.</li>
<li>Runs a variant of the Nintendo 3DS’s operating system rather than
something Wii/Wii U like.</li>
</ul>
<p><strong>iPhone/iPad/Apple Silicon Macs</strong></p>
<ul>
<li>Not a game console but share a similar security architecture.</li>
</ul>
<aside class="notes">
<p>I didn’t have time to cover all the consoles in this presentation.
Here are just a few more interesting ones.</p>
</aside>
</section>
<section id="section-1" class="slide level2"
data-background-image="./images/ship_of_theseus.jpg">
<h2 data-background-image="./images/ship_of_theseus.jpg"></h2>
<h3 id="what-is-a-pc-1">What is a PC?</h3>
<ul>
<li><del>8259 Programmable Interrupt Controller (PIC)</del>
<em>APIC</em></li>
<li><del>8253 Programmable Interval Timer (PIT)</del> <em>APIC</em></li>
<li><del>8250 UART at I/O <code>3f8h</code></del> <em>USB</em></li>
<li><del>8042 PS/2 Keyboard Controller</del> <em>USB</em></li>
<li><del>MC146818 RTC/CMOS</del> <em>Part of the Southbridge</em></li>
<li><del>ISA bus</del> <em>PCI Express</em></li>
<li><del>VGA</del> <em>Discrete Graphics with a GPU</em></li>
</ul>
<p>PS4, Wii, Wii U support Linux.</p>
<p>Xbox One runs (modified) Windows.</p>
<div class="smaller">
<p><em>Background Image Credit: Chatterton, E. Keble (Edward Keble),
1878–1944</em></p>
<p><em><a href="https://fail0verflow.com/media/33c3-slides/#/24">What is
a PC source:
https://fail0verflow.com/media/33c3-slides/#/24</a></em></p>
</div>
</section>
<section id="thanks-for-listening" class="slide level2">
<h2>Thanks for Listening</h2>
</section>
    </div>
  </div>

  <script src="https://unpkg.com/reveal.js//dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="https://unpkg.com/reveal.js//plugin/notes/notes.js"></script>
  <script src="https://unpkg.com/reveal.js//plugin/search/search.js"></script>
  <script src="https://unpkg.com/reveal.js//plugin/zoom/zoom.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // reveal.js plugins
        plugins: [
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    </body>
</html>
